<!DOCTYPE HTML>
<TITLE>Tetris</TITLE>
<LINK REL="stylesheet" HREF="https://webdevkit.net/styles.css">

<!-- GLOBALS -->
<SCRIPT>
function $(selector) {
	return document.querySelectorAll(selector);
}
function listen(element, types, listener, options) {
	types = types.split(" ")
	for (let type of types) element.addEventListener(type, listener, options)
}
</SCRIPT>

<!-- MOUSE -->
<SCRIPT>
let Mouse = undefined
listen(document, "click mousemove", (event) => {
	Mouse = {}
	let update = (event) => {
		Mouse.x = Math.round(event.clientX / window.innerWidth * 100) / 100,
		Mouse.y = Math.round(event.clientY / window.innerHeight * 100) / 100
	}
	update(event)
	listen(document, "click mousemove", update)
},	{ once: true })
</SCRIPT>

<!-- KEYBOARD -->
<SCRIPT>
let Keyboard = undefined
listen(document, "keydown keyup", (event) => {
	Keyboard = {}
	let update = (event) => {
		if (event.type === "keydown") Keyboard[event.key] = true
		else if (event.type === "keyup") delete Keyboard[event.key]
	}
	update(event)
	listen(document, "keydown keyup", update)
}, { once: true })
</SCRIPT>

<STYLE>
:ROOT { --x: 0.5; --y: 0.5; }
Q::before { content: "\201C" }
Q::after { content: "\201D" }

#Tetris {
font-family: "IBM Plex Serif", sans-serif; font-size: 2.4vh; line-height: 1.4;
max-width: 80ch; margin: 0 auto; padding: 0 2em 25vh }
#Tetris H1 { text-align: center }
#Tetris HEADER {
min-height: 100vh; transform: translateY(-2em); align-content: center; justify-items: center; display: grid }
#Tetris HEADER H1, #Tetris HEADER H2 { grid-column: 1; grid-row: 1 }
#Tetris HEADER H1, #Tetris HEADER H2 { margin: 0 }
#Tetris HEADER A, #Tetris HEADER IMG { border-radius: 4pt }
#Tetris HEADER H1 IMG { opacity: 0 }
#Tetris HEADER H1 A { background: url("Artwork/Background.jpg"); background-size: contain }
#Tetris HEADER A { display: inline-flex; box-shadow: 0 1em 1em rgba(0,0,0,0.33) }
#Tetris HEADER H1 A::before { content: ""; display: block;
position: absolute; top: 0; left: 0; width: 100%; height: 100%;
background: url("Artwork/Logo Shadow.png") center no-repeat; background-size: 100% 100%; }
#Tetris HEADER H1 A::after { content: ""; display: block;
position: absolute; top: 0; left: 0; width: 100%; height: 100%;
background: url("Artwork/Logo Fill.png") center no-repeat; background-size: 100% 100%; }
#Tetris HEADER A { --stack: 0;  --maxX: 1; --maxY: 1;  --offsetX: calc(var(--x) * 2 - 1); --offsetY: calc(var(--y) * 2 - 1);
box-shadow: calc(var(--offsetX) * var(--maxX) * -1vmin + 0.5vmin)
            calc(var(--offsetY) * var(--maxY) * -1vmin + 0.5vmin)
            2vmin rgba(0,0,0,0.25); 
/* transition: all 0.5s ease-in-out; */
transform: perspective(100vmin)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg)) }
#Tetris HEADER H1 A::before { --stack: 1 }
#Tetris HEADER H1 A::after { --stack: 2 } 
#Tetris HEADER H1 A::before, #Tetris HEADER A::after {
filter: drop-shadow(calc(var(--offsetX) * -3px) calc(var(--offsetY) * -3px) 1px rgba(0,0,0,0.2));
transform: perspective(100vmin)
           translateX(calc(var(--stack) * var(--offsetX) * var(--maxX) * 0.1vmin))
           translateY(calc(var(--stack) * var(--offsetY) * var(--maxY) * 0.1vmin)) }

#Tetris HEADER H1 { transition: transform 0.25s ease-in-out; }
#Tetris HEADER H1:hover { transform: scale(1.25) }
#Tetris HEADER H1:hover A { --maxX: 10; --maxY: 1 }
/*
#Tetris HEADER H1 A { /*backface-visibility: hidden;* / opacity: 1;
transform: /*perspective(100vmin) rotateY(0deg)* /
           perspective(100vmin)
			  scaleX(-1)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 180deg)) }
#Tetris HEADER H2 A { backface-visibility: hidden; opacity: -10;
transform: /*perspective(100vmin) rotateY(180deg)* /
			  perspective(100vmin)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg + 180deg)) }

#Tetris HEADER.hovered H1 { --maxX: 1; --maxY: 1; transform: perspective(100vmin)
           rotateX(calc(var(--offsetY) * var(--maxY) * -1deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 1deg)) }

#Tetris HEADER.hovered H1 A { opacity: -10; transform: perspective(100vmin) scale(-1.25, 1.25)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 0deg)) }
#Tetris HEADER.hovered H2 A { opacity: 1; transform: perspective(100vmin) scale(1.25) 
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg)) }
*/
#Tetris H2 A { display: none }
/* #Tetris { opacity: 0; transition: opacity 2s; transition-delay: 1s; }
#Tetris.load { opacity: 1 }
#Tetris H1 A { opacity: 1; animation: flipX2 1s ease-in-out; animation-fill-mode: forwards }
#Tetris H2 A { opacity: -1; animation: flipX4 1s ease-in-out; animation-fill-mode:  forwards }
#Tetris HEADER.hovered H1 A { animation: flipX 1s ease-in-out; animation-fill-mode:  forwards }
#Tetris HEADER.hovered H2 A { animation: flipX3 1s ease-in-out; animation-fill-mode:  forwards } */
/* 
@keyframes flipX {
from { opacity: 1;
	transform: perspective(100vmin) scaleX(-1)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 180deg))
}
to { opacity: 1; 
	transform: perspective(100vmin) scale(-1.25, 1.25)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 0deg)) }
}

@keyframes flipX2 {
from { opacity: 1;
	transform: perspective(100vmin) scale(-1.25, 1.25)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 0deg))
}
to { opacity: 1; 
	transform: perspective(100vmin) scaleX(-1)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 180deg)) }
}

@keyframes flipX3 {
from { opacity: -1;
	transform: perspective(100vmin) scaleX(-1)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 0deg))
}
50% { opacity: -1; }
51% { opacity: 1; }
to { opacity: 1; 
	transform: perspective(100vmin) scale(-1.25, 1.25)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg + 180deg)) }
}

@keyframes flipX4 {
from { opacity: 1;
	transform: perspective(100vmin) scale(-1.25, 1.25)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg + 180deg))
}
49% { opacity: 1; }
50% { opacity: -1; }
to { opacity: -1; 
	transform: perspective(100vmin) scaleX(-1)
           rotateX(calc(var(--offsetY) * var(--maxY) * -2deg))
           rotateY(calc(var(--offsetX) * var(--maxX) * 2deg - 0deg)) }
} */


/* 
#tetris HEADER A { animation: 11s test linear infinite
#tetris HEADER A::before { animation: 11s stack linear infinite }
#tetris HEADER A::after { --stack: 1.5; animation: 11s stack linear infinite }
@keyframes test {
from { transform: perspective(100vmax) 
                rotateX(calc(var(--offsetX) * var(--maxX) * 1deg)) 
                rotateY(calc(var(--offsetY) * var(--maxY) * -1deg)) }
25% { transform: perspective(100vmax) 
                 rotateX(calc(var(--offsetX) * var(--maxX) * 1deg)) 
                 rotateY(calc(var(--offsetY) * var(--maxY) * 1deg)) }
50% { transform: perspective(100vmax) 
                 rotateX(calc(var(--offsetX) * var(--maxX) * -1deg)) 
                 rotateY(calc(var(--offsetY) * var(--maxY) * 1deg)) }
75% { transform: perspective(100vmax) 
                 rotateX(calc(var(--offsetX) * var(--maxX) * -1deg)) 
                 rotateY(calc(var(--offsetY) * var(--maxY) * 1deg)) }
to { transform: perspective(100vmax) 
                rotateX(calc(var(--offsetX) * var(--maxX) * 1deg)) 
                rotateY(calc(var(--offsetY) * var(--maxY) * -1deg)) }
}
@keyframes stack {
from { transform: translateX(calc(var(--stack) * -2px)) translateY(calc(var(--stack) * 1px)) }
25% { transform: translateX(calc(var(--stack) * 1px)) translateY(calc(var(--stack) * 1px)) }
50% { transform: translateX(calc(var(--stack) * 1px)) translateY(calc(var(--stack) * -2px)) }
75% { transform: translateX(calc(var(--stack) * -2px)) translateY(calc(var(--stack) * -2px)) }
to { transform: translateX(calc(var(--stack) * -2px)) translateY(calc(var(--stack) * 1px)) }
} */
#debug { position: fixed; z-index: 1; top: 0; left: 0; width: 100vw; height: 100vh; padding: 1em; background: transparent; color: var(--color, black); border: none; pointer-events: none;
font-family: "IBM Plex Mono", monospace; font-weight: 100; font-size: 8pt }
</STYLE>
<ARTICLE ID="Tetris">
<HEADER>
<H1><A HREF="Artwork.jpg"><IMG ALT="Tetris" SRC="Artwork.jpg" WIDTH="512" HEIGHT="512"/></A></H1>
<H2><A HREF="Description.jpg"><IMG ALT="From Russia with Fun!" SRC="Description.jpg" WIDTH="512" HEIGHT="512"/></A></H1>
</HEADER>
<SCRIPT>
listen(window, "load", () => { $("#Tetris")[0].classList.add("load") })
listen(document, "mousemove", () => {
	if (!Mouse) return
	document.documentElement.style.setProperty("--x", Mouse.x)
	document.documentElement.style.setProperty("--y", Mouse.y)
})
// let timeout
// for (let $header of $("#Tetris HEADER A"))
// 	listen($header, "mouseenter mouseleave", (event) => {
// 		if (timeout) clearTimeout(timeout)
// 		setTimeout(() => $("#Tetris HEADER")[0].classList.toggle("hovered", event.type === "mouseenter"), event.type === "mouseenter" ? 1000 : 3000)
// 	})
listen($("#Tetris H1 A")[0], "mouseenter", () => {
	//console.log("mouseenter")
})
listen($("#Tetris H1 A")[0], "mouseleave", () => {
	//console.log("mouseleave")
})
listen($("#Tetris H1 A")[0], "mousemove", () => {
	//console.log(Mouse.x < 0.5 ? "left" : "right")
})
listen($("#Tetris H1 A")[0], "click", (event) => {
	let normalize = (value, range) => (value * 2 - range) / range
	let normalizedLayerX = normalize(event.layerX, event.target.offsetWidth)
	if (Math.abs(normalizedLayerX) < 0.67) return

	event.preventDefault()
	if (normalizedLayerX < 0.5) console.log("clicked left")
	else console.log("clicked right")
})
</SCRIPT>

<P>Ahhh&hellip; Tetris. <Q>The relentless building block video puzzle</Q> game that launched with Nintendo&rsquo;s Game&nbsp;Boy in 1989.</P>
<P>While the Tetris video game in general has an interesting and complicated history dating back as early as 1984, it was the Nintendo Game&nbsp;Boy version that I have the fondest memories of. Whether it was taking turns to get the high score with my mom, dad and brother or playing under the passing streetlights in the back of our van as we drove home from a family gathering, Tetris will always be one of remembered as one of my favorite video games of all time.</P>

<P>The game&rsquo;s title, &ldquo;Tetris,&rdquo; is a portmanteau of <EM>tetromino</EM> (a shape that is comprised of four blocks, kind of like how a <EM>domino</EM> is a shape made up of two blocks) combined with “tennis”, Pajitnov’s favorite sport.</P>
<!-- <H2><A HREF="Description.jpg"><IMG ALT="From Russia with Fun!" SRC="Description.jpg" WIDTH="512" HEIGHT="512"/></A></H1> -->
</ARTICLE>

<!-- DEBUGGER -->
<DIV ID="debug" STYLE="opacity: 1">&nbsp;</DIV>
<SCRIPT>
let platformIcon = 'platform' in navigator ? '\uF8FF' : ''
let $debug = document.querySelector("#debug");
if ($debug.style.opacity) {
	listen(window, "resize", debug)
	listen(document, "click mousemove keydown keyup scroll", debug);
	function debug(event) { 
		$debug.innerText = ""
		let printLine = (line) => $debug.innerText += `${line}\n`
		printLine(`Platform: ${platformIcon ? platformIcon + ' ' : ''}${'platform' in navigator ? navigator.platform : '?'}`)
		printLine(``)
		printLine(`Screen Size: ${'screen' in window ? window.screen.width : '?'}, ${'screen' in window ? window.screen.height : '?'}`)
		printLine(`Screen Color Depth: ${'screen' in window ? window.screen.colorDepth + '-bit' : '?'}`)
		printLine(`Screen Pixel Depth: ${'screen' in window ? window.screen.pixelDepth + '-bit' : '?'}`)
		printLine(``)
		printLine(`Window Size: ${'innerWidth' in window ? window.innerWidth : '?'}, ${'innerHeight' in window ? window.innerHeight : '?'}`)
		printLine(`Window Scroll: ${'scrollX' in window ? window.scrollX : '?'}, ${'scrollY' in window ? window.scrollY : '?'}`)
		printLine(``)
		printLine(`Mouse Client: ${event && 'clientX' in event ? event.clientX : '?'}, ${event && 'clientY' in event ? event.clientY : '?'}`)
		printLine(`Mouse Layer: ${event && 'layerX' in event ? event.layerX : '?'}, ${event && 'layerY' in event ? event.layerY : '?'}`)
		printLine(`Mouse Page: ${event && 'pageX' in event ? event.pageX : '?'}, ${event && 'pageY' in event ? event.pageY : '?'}`)
		printLine(`Mouse Screen: ${event && 'screenX' in event ? event.screenX : '?'}, ${event && 'screenY' in event ? event.screenY : '?'}`)
		printLine(``)
		let keys = ``
		if (Keyboard) {
			keys = Object.keys(Keyboard)
			// keys = Object.keys(Keyboard).map(key => {
			// 	switch (key) {
			// 	case "Shift": return '\u21E7'
			// 	case "Control": return '\u2303'
			// 	case "Alt": return '\u2325'
			// 	case "Meta": return '\u2318'
			// 	default: return key }
			// })
		}
		printLine(`Keyboard: ${event && keys.length ? keys.join('') : '?'}`)

		//if (Mouse) $debug.innerText += `Mouse Normal X/Y: ${Mouse.x}, ${Mouse.y}\n`
		//if (Mouse) $debug.innerText += `Mouse Normal X/Y: ${Mouse.x}, ${Mouse.y}\n`
	}
	debug()
}
</SCRIPT>